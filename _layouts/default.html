<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: "en" }}">
{% include head.html %}
<body>
  {% include header.html %}
  <main class="main">
    <div class="container">
      <div class="products">
      {{ content }}
      </div>
    </div>
  </main>
</body>
<link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.2.2/default/snipcart.css" />
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js" integrity="sha384-ODmDIVzN+pFdexxHEHFBQH3/9/vQ9uori45z4JjnFsRydbmQbmL5t1tQ0culUzyK" crossorigin="anonymous"></script>
<script src="https://unpkg.com/cart-localstorage@1.1.4/dist/cart-localstorage.min.js" type="text/javascript"></script>
<!-- <script async src="https://cdn.snipcart.com/themes/v3.2.2/default/snipcart.js"></script>
<div id="snipcart" data-api-key="Your snipcart API token here" hidden></div> -->
<script>
  const badge = document.querySelector('.badge')
  badge.innerText = cartLS.list().reduce((prev, curr) => prev + curr.quantity, 0)

  const cartBody = document.querySelector('.cart');
  cartLS.list().forEach((item) => {
    const itemHTML = `<tr>
      <td>#1</td>
      <td>${item.name}</td>
      <td style="width: 60px;">
        <button type="button" class="btn btn-block btn-sm btn-outline-primary" onclick="cartLS.quantity('${item.id}',1)">+</button>
      </td>
      <td>${item.quantity}</td>
      <td style="width: 60px;">
        <button type="button" class="btn btn-block btn-sm btn-outline-primary" onclick="cartLS.quantity('${item.id}',-1)">-</button>
      </td>
      <td class="text-right">${item.price * item.quantity}â‚¬</td>
      <td class="text-right"><button class="btn btn-primary" onclick="cartLS.remove('${item.id}')">Delete</button></td>
    </tr>`

    cartBody.insertAdjacentHTML('beforeend', itemHTML)
  });

  const total = document.querySelectorAll('.total')
  console.log(total)
  total.innerText = cartLS.total();

  const buttons = document.querySelectorAll('.buy-button')
  buttons.forEach((button) => {
    button.addEventListener('click', (event) => {
      const { itemId, itemName, itemPrice } = event.currentTarget.dataset
      cartLS.add({ id: itemId, name: itemName, price: itemPrice })
      total.innerText = cartLS.list().reduce((prev, curr) => prev + curr.quantity, 0)
    })
  });
</script>
</html>
